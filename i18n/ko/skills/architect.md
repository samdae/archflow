---
name: Architect
description: ë‘ ê´€ì ì˜ ì„œë¸Œì—ì´ì „íŠ¸ê°€ í˜‘ì˜í•˜ì—¬ ìµœì ì˜ ì„¤ê³„ì•ˆ ë„ì¶œ. Triggers on "ì„¤ê³„", "architect", "ì•„í‚¤í…ì²˜", "ê¸°ëŠ¥ ì„¤ê³„". implement ìŠ¤í‚¬ì˜ ì…ë ¥ ìƒì„±.
version: 2.0.0
---

# Architect Workflow

ë‘ ê´€ì ì˜ ì„œë¸Œì—ì´ì „íŠ¸ê°€ í˜‘ì˜í•˜ì—¬ ìµœì ì˜ ì„¤ê³„ì•ˆì„ ë„ì¶œí•©ë‹ˆë‹¤.

## ğŸ’¡ ê¶Œì¥ ëª¨ë¸

**Opus í•„ìˆ˜** - ì„¤ê³„ í’ˆì§ˆì´ êµ¬í˜„ í’ˆì§ˆì„ ê²°ì •í•¨

â†’ ë¹„ìš© ì ˆê°ì´ í•„ìš”í•´ë„ ì´ ë‹¨ê³„ëŠ” Opus ìœ ì§€ ê¶Œì¥

## ğŸ”„ ë„êµ¬ í´ë°± (Fallback)

| ë„êµ¬ | ì—†ì„ ë•Œ ëŒ€ì²´ ë°©ë²• |
|------|-----------------|
| **Read/Grep** | ì‚¬ìš©ìì—ê²Œ íŒŒì¼ ê²½ë¡œ ëª©ë¡ ìš”ì²­ â†’ í•„ìš”í•œ ë¶€ë¶„ ë³µì‚¬-ë¶™ì—¬ë„£ê¸° ìš”ì²­ |
| **AskQuestion** | "ë‹¤ìŒ ì¤‘ ì„ íƒí•´ì£¼ì„¸ìš”: 1) ì˜µì…˜A 2) ì˜µì…˜B 3) ì˜µì…˜C" í˜•íƒœë¡œ ì§ˆë¬¸ |
| **Task** | ì„œë¸Œì—ì´ì „íŠ¸ í˜¸ì¶œ ëŒ€ì‹  ë‹¨ê³„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ëŒ€ì²´, ì‚¬ìš©ìê°€ ê° ê´€ì  ì…ë ¥ |

## ğŸ“ ë¬¸ì„œ êµ¬ì¡°

```
projectRoot/
  â””â”€â”€ docs/
        â””â”€â”€ {serviceName}/
              â”œâ”€â”€ requirements.md   # require-refine ìŠ¤í‚¬ ì¶œë ¥
              â”œâ”€â”€ architect.md      # â† ì´ ìŠ¤í‚¬ì˜ ì¶œë ¥
              â””â”€â”€ changelog.md      # bugfix ìŠ¤í‚¬ ì¶œë ¥
```

**serviceName ì¶”ë¡ **: ì…ë ¥ íŒŒì¼ ê²½ë¡œ `docs/{serviceName}/requirements.md`ì—ì„œ ìë™ ì¶”ì¶œ

## âš ï¸ Global Rule: ë…¼ë¦¬ì  ë¶ˆì¼ì¹˜ ì²˜ë¦¬

ì‚¬ìš©ìì˜ í”¼ë“œë°±ì´ Phase 0ì˜ Goalì´ë‚˜ ê¸°ì¡´ ì„¤ê³„ ì›ì¹™ê³¼ ì¶©ëŒí•  ê²½ìš°:

### 1ë‹¨ê³„: ë¶ˆì¼ì¹˜ ê°ì§€ ë° ë³´ê³ 

```markdown
âš ï¸ **ë…¼ë¦¬ì  ë¶ˆì¼ì¹˜ ê°ì§€**

**ê¸°ì¡´ ì„¤ê³„**: {ê¸°ì¡´ì— í™•ì •ëœ ì„¤ê³„ ë‚´ìš©}
**ì‚¬ìš©ì í”¼ë“œë°±**: {ì¶©ëŒí•˜ëŠ” ìƒˆ ë‚´ìš©}
**ì¶©ëŒ ì§€ì **: {ì–´ë–¤ ì›ì¹™/ê²°ì •ì´ ì¶©ëŒí•˜ëŠ”ì§€}
```

### 2ë‹¨ê³„: ì˜ì‚¬ê²°ì • ì„ íƒì§€ ì œì‹œ

**AskQuestionìœ¼ë¡œ ì„ íƒ ìš”ì²­:**

```json
{
  "title": "ì„¤ê³„ ë¶ˆì¼ì¹˜ í•´ê²°",
  "questions": [
    {
      "id": "resolution",
      "prompt": "ê¸°ì¡´ ì„¤ê³„ì™€ ìƒˆ í”¼ë“œë°±ì´ ì¶©ëŒí•©ë‹ˆë‹¤. ì–´ë–»ê²Œ ì²˜ë¦¬í• ê¹Œìš”?",
      "options": [
        {"id": "keep_original", "label": "ê¸°ì¡´ ì„¤ê³„ ìœ ì§€ - ìƒˆ í”¼ë“œë°± ë¬´ì‹œ"},
        {"id": "accept_new", "label": "ìƒˆ í”¼ë“œë°± ì±„íƒ - ì„¤ê³„ ìˆ˜ì •"},
        {"id": "merge", "label": "ë³‘í•© - ë‘ ë‚´ìš© ëª¨ë‘ ë°˜ì˜ (ì„¤ëª… ì…ë ¥)"},
        {"id": "re_debate", "label": "ì„œë¸Œì—ì´ì „íŠ¸ ì¬í˜‘ì˜ - ìƒˆ ì¡°ê±´ìœ¼ë¡œ ì¬í† ë¡ "}
      ]
    }
  ]
}
```

**ì„ íƒë³„ ì²˜ë¦¬:**
- `keep_original` â†’ ê²½ê³  ë¡œê·¸ ë‚¨ê¸°ê³  ê¸°ì¡´ ìœ ì§€
- `accept_new` â†’ ì„¤ê³„ ìˆ˜ì •, Risks & Tradeoffsì— ë³€ê²½ ì´ìœ  ê¸°ë¡
- `merge` â†’ ì‚¬ìš©ìì—ê²Œ ë³‘í•© ë°©ë²• ì¶”ê°€ ì…ë ¥ ìš”ì²­
- `re_debate` â†’ Phase 3ë¡œ ëŒì•„ê°€ ìƒˆ ì¡°ê±´ìœ¼ë¡œ í˜‘ì˜ ì¬ê°œ

## ì—­í•  ì •ì˜

| ì—ì´ì „íŠ¸ | ì—­í•  | ì»¨í…ìŠ¤íŠ¸ |
|----------|------|----------|
| domain-architect | í”„ë¡œì íŠ¸ ë§¥ë½ ê¸°ë°˜ ì„¤ê³„ | ìš”êµ¬ì‚¬í•­ MD + í”„ë¡œì íŠ¸ êµ¬ì¡° |
| best-practice-advisor | ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ì œì•ˆ | ê¸°ëŠ¥ ìš”ì²­ë§Œ (ì»¨í…ìŠ¤íŠ¸ ì—†ìŒ) |

## Phase 0: ìŠ¤í‚¬ ì§„ì…

### 0-0. ëª¨ë¸ ì•ˆë‚´ (ì‹œì‘ ì‹œ ì¶œë ¥)

> âš ï¸ **ì´ ìŠ¤í‚¬ì€ Opus ëª¨ë¸ ì‚¬ìš©ì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.**
> ì„¤ê³„ í’ˆì§ˆì´ êµ¬í˜„ í’ˆì§ˆì„ ê²°ì •í•˜ë¯€ë¡œ, ë¹„ìš© ì ˆê°ì´ í•„ìš”í•´ë„ ì´ ë‹¨ê³„ëŠ” Opusë¥¼ ìœ ì§€í•˜ì„¸ìš”.
>
> **ì…ë ¥**: `docs/{serviceName}/requirements.md`
> **ì¶œë ¥**: `docs/{serviceName}/architect.md`

### 0-1. ì…ë ¥ ì •ë³´ ìˆ˜ì§‘

ìŠ¤í‚¬ë§Œ í˜¸ì¶œ ì‹œ (ì…ë ¥ ì •ë³´ ì—†ì´) **AskQuestionìœ¼ë¡œ í•„ìš” ì •ë³´ ì•ˆë‚´**:

```json
{
  "title": "ì„¤ê³„ í˜‘ì˜ ì‹œì‘",
  "questions": [
    {
      "id": "has_requirements",
      "prompt": "ìš”êµ¬ì‚¬í•­ ë¬¸ì„œê°€ ìˆë‚˜ìš”? (docs/{serviceName}/requirements.md)",
      "options": [
        {"id": "yes", "label": "ì˜ˆ - @íŒŒì¼ê²½ë¡œë¡œ ì•Œë ¤ë“œë¦´ê²Œìš”"},
        {"id": "no", "label": "ì•„ë‹ˆì˜¤ - ìš”êµ¬ì‚¬í•­ ì •ë¦¬ë¶€í„° í•„ìš”í•´ìš”"}
      ]
    }
  ]
}
```

**ì‘ë‹µë³„ ì²˜ë¦¬:**
- `yes` â†’ íŒŒì¼ ê²½ë¡œ ì…ë ¥ ìš”ì²­ â†’ Phase 1ë¡œ ì§„í–‰
- `no` â†’ **require-refine** ìŠ¤í‚¬ë¡œ ì•ˆë‚´

### 0-2. serviceName ì¶”ë¡ 

ì…ë ¥ë°›ì€ íŒŒì¼ ê²½ë¡œì—ì„œ serviceName ì¶”ì¶œ:
- ì…ë ¥: `docs/alert/requirements.md`
- ì¶”ì¶œ: `serviceName = "alert"`
- ì¶œë ¥ ê²½ë¡œ: `docs/alert/architect.md`

## Phase 1: ì´ˆê¸° ì…ë ¥ ìˆ˜ì§‘

ì‚¬ìš©ìë¡œë¶€í„° ë‹¤ìŒì„ í™•ì¸:
- ìš”êµ¬ì‚¬í•­ ë¬¸ì„œ ê²½ë¡œ (ì˜ˆ: `@docs/alert/requirements.md`)
- êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ê¸°ëŠ¥ ì„¤ëª… (ì¶”ê°€ ì„¤ëª… í•„ìš” ì‹œ)

**ì´ë¯¸ íŒŒì¼ì´ ì œê³µëœ ê²½ìš°** â†’ ë°”ë¡œ Phase 2ë¡œ ì§„í–‰

## Phase 2: ë³‘ë ¬ ì´ˆê¸° ì„¤ê³„

### 2-A: Domain Architect í˜¸ì¶œ

**Task ë„êµ¬**ë¡œ `domain-architect` ì„œë¸Œì—ì´ì „íŠ¸ í˜¸ì¶œ:

```
Task(
  subagent_type: "domain-architect",
  description: "í”„ë¡œì íŠ¸ ë§¥ë½ ê¸°ë°˜ ì„¤ê³„",
  prompt: """
    ìš”êµ¬ì‚¬í•­: {ìš”êµ¬ì‚¬í•­ MD ë‚´ìš©}
    ê¸°ëŠ¥ ì„¤ëª…: {ê¸°ëŠ¥ ì„¤ëª…}
    í”„ë¡œì íŠ¸ êµ¬ì¡°: {í”„ë¡œì íŠ¸ íƒìƒ‰ ê²°ê³¼}

    ìœ„ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì„¤ê³„ì•ˆì„ ì œì‹œí•˜ë¼.
  """
)
```

Expected output:
- ì„¤ê³„ì•ˆ (êµ¬í˜„ ë°©ì‹, íŒŒì¼ êµ¬ì¡°, ì˜ì¡´ì„±)
- í”„ë¡œì íŠ¸ ì œì•½ì‚¬í•­ ê³ ë ¤ì‚¬í•­
- ìš°ë ¤ ì‚¬í•­ ë° íŠ¸ë ˆì´ë“œì˜¤í”„

### 2-B: Best Practice Advisor í˜¸ì¶œ

**Task ë„êµ¬**ë¡œ `best-practice-advisor` ì„œë¸Œì—ì´ì „íŠ¸ í˜¸ì¶œ:

```
Task(
  subagent_type: "best-practice-advisor",
  description: "ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ê¸°ë°˜ ì„¤ê³„",
  prompt: """
    ê¸°ëŠ¥ ì„¤ëª…: {ê¸°ëŠ¥ ì„¤ëª…ë§Œ, í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ ì—†ìŒ}

    ì´ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ë•Œ ì´ìƒì ì¸ ì„¤ê³„ì•ˆì„ ì œì‹œí•˜ë¼.
  """
)
```

Expected output:
- ì´ìƒì ì¸ ì„¤ê³„ì•ˆ (ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ê¸°ë°˜)
- ê¶Œì¥ íŒ¨í„´ ë° ì•ˆí‹°íŒ¨í„´
- ì¼ë°˜ì ì¸ ì£¼ì˜ì‚¬í•­

## Phase 3: 1ì°¨ í˜‘ì˜ (ìë™)

ì–‘ì¸¡ì— ë‹¤ìŒ í”„ë¡¬í”„íŠ¸ ì „ë‹¬:

```
ì§€ê¸ˆë¶€í„° ë‹¤ë¥¸ LLMì˜ ë‹µë³€ì„ ì „ë‹¬í•  ê²ƒì´ë‹¤.
ê·¸ LLM ì—­ì‹œ ë™ì¼í•œ ê¸°ëŠ¥ ì •ì˜ì— ëŒ€í•´ ì§€ì‹œë°›ì•˜ë‹¤.

ìƒëŒ€ë°© ì„¤ê³„ì•ˆ:
{other_agent_response}

ë„ˆì˜ ì…ì¥ì—ì„œ ê²€í†  í›„ ë‹¤ìŒì„ ì œê³µí•˜ë¼:
1. ë™ì˜í•˜ëŠ” ë¶€ë¶„
2. ìš°ë ¤ë˜ëŠ” ë¶€ë¶„
3. ëŒ€ì•ˆ ì œì•ˆ (ìˆë‹¤ë©´)
4. í•©ì˜ ê°€ëŠ¥ ì—¬ë¶€: [í•©ì˜í•¨ / ì¶”ê°€ ë…¼ì˜ í•„ìš”]
```

### Round 1
- Domain Architectì˜ ì„¤ê³„ì•ˆ â†’ Best Practice Advisorì—ê²Œ ì „ë‹¬
- Best Practice Advisor ê²€í†  ì˜ê²¬ ë°˜í™˜

### Round 2
- Best Practice Advisorì˜ ê²€í†  ì˜ê²¬ â†’ Domain Architectì—ê²Œ ì „ë‹¬
- Domain Architect ìˆ˜ì •/ë°˜ë°• ë°˜í™˜

## Phase 4: ì‚¬ìš©ì ì²´í¬í¬ì¸íŠ¸

2ë¼ìš´ë“œ ì™„ë£Œ í›„ **ë°˜ë“œì‹œ** ì‚¬ìš©ìì—ê²Œ ì¤‘ê°„ ë³´ê³ .

### ë³´ê³  í˜•ì‹

| í•­ëª© | Domain Architect | Best Practice Advisor |
|------|------------------|----------------------|
| í•µì‹¬ ì£¼ì¥ | (1-2ë¬¸ì¥ ìš”ì•½) | (1-2ë¬¸ì¥ ìš”ì•½) |
| í•©ì˜ëœ ë¶€ë¶„ | (ëª©ë¡) | (ëª©ë¡) |
| ìŸì  | (ëª©ë¡) | (ëª©ë¡) |

### ì‚¬ìš©ì ì„ íƒì§€ ì œì‹œ

**AskQuestion ë„êµ¬ ì‚¬ìš©** (ë‚´ìš©ì€ í˜‘ì˜ ê²°ê³¼ì— ë”°ë¼ ë™ì  ìƒì„±):

| í•„ë“œ | ì„¤ëª… |
|------|------|
| title | í˜‘ì˜ ì£¼ì œ ë°˜ì˜ (ì˜ˆ: "ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§ ì„¤ê³„ í˜‘ì˜") |
| prompt | ìœ„ ë³´ê³  í˜•ì‹ í…Œì´ë¸” ìš”ì•½ í¬í•¨ |
| options | ì•„ë˜ 4ê°€ì§€ ê¸°ë³¸ ì œê³µ, ìƒí™©ì— ë”°ë¼ ì¡°ì • |

**ê¸°ë³¸ ì„ íƒì§€:**
- `domain`: Domain Architect ì•ˆ ì±„íƒ - í”„ë¡œì íŠ¸ í˜„ì‹¤ ìš°ì„ 
- `best`: Best Practice ì•ˆ ì±„íƒ - ì´ìƒì  ì„¤ê³„ ìš°ì„ 
- `continue`: í˜‘ì˜ ê³„ì† - ì¶”ê°€ 2ë¼ìš´ë“œ ì§„í–‰
- `custom`: íŠ¹ì • ìŸì  ì§€ì • - ì§ì ‘ ì¡°í•©

**ì„ íƒì§€ ì¡°ì • ê·œì¹™:**
- ì–‘ì¸¡ í•©ì˜ ì™„ë£Œ ì‹œ â†’ `continue` ì œì™¸
- í•œìª½ë§Œ ëª…í™•íˆ ìš°ì„¸ ì‹œ â†’ í•´ë‹¹ ì•ˆì„ ê¸°ë³¸ ê¶Œì¥ìœ¼ë¡œ í‘œì‹œ

**ì£¼ì˜**: Plan modeê°€ ì•„ë‹Œ Normal modeì—ì„œ ì‹¤í–‰. AskQuestionìœ¼ë¡œ ì¤‘ê°„ ê°œì… + ìµœì¢… íŒŒì¼ ì‘ì„± ëª¨ë‘ ê°€ëŠ¥.

## Phase 5: í›„ì† ì²˜ë¦¬

### ì„ íƒì§€ 1, 2, 4 â†’ ì¦‰ì‹œ Phase 6ìœ¼ë¡œ
- ì‚¬ìš©ì ê²°ì • ë°˜ì˜í•˜ì—¬ ìµœì¢… ì„¤ê³„ì•ˆ ì •ë¦¬

### ì„ íƒì§€ 3 â†’ ì¶”ê°€ í˜‘ì˜
- Round 3-4 ì§„í–‰
- 4ë¼ìš´ë“œ í›„ **ìë™ ì¢…ë£Œ** (ë¬´í•œ ë£¨í”„ ë°©ì§€)
- ë¯¸í•©ì˜ ì‹œ Domain Architect ì•ˆ + Best Practice ê¶Œê³ ì‚¬í•­ ë³‘ê¸°

## Phase 5.5: í’ˆì§ˆ ê²Œì´íŠ¸ ê²€ì¦

ì„¤ê³„ ë¬¸ì„œ ì‘ì„± ì „, **í•„ìˆ˜ í•„ë“œ ì™„ì„±ë„ ê²€ì¦**:

### í•„ìˆ˜ ê²€ì¦ í•­ëª©

| í•­ëª© | ê²€ì¦ ê¸°ì¤€ | ë¯¸ë‹¬ ì‹œ ì²˜ë¦¬ |
|------|----------|------------|
| DB ìŠ¤í‚¤ë§ˆ | ëª¨ë“  í…Œì´ë¸”ì˜ ì „ì²´ ì»¬ëŸ¼ ì •ì˜ | ì§ˆë¬¸ ë£¨í”„ |
| Code Mapping | ëª¨ë“  ê¸°ëŠ¥ì— íŒŒì¼/í´ë˜ìŠ¤/ë©”ì„œë“œ ëª…ì‹œ | ì§ˆë¬¸ ë£¨í”„ |
| API Spec | ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ Request/Response ì •ì˜ | ì§ˆë¬¸ ë£¨í”„ |
| ì—ëŸ¬ ì •ì±… | ì£¼ìš” ì—ëŸ¬ ìƒí™© ë° ì‘ë‹µ ì •ì˜ | ì§ˆë¬¸ ë£¨í”„ |

### ë¯¸ë‹¬ ì‹œ ì§ˆë¬¸ ë£¨í”„

```json
{
  "title": "ì„¤ê³„ ì •ë³´ ë³´ì™„ í•„ìš”",
  "questions": [
    {
      "id": "missing_info",
      "prompt": "ë‹¤ìŒ ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤:\n- {ëˆ„ë½ í•­ëª© ëª©ë¡}\n\nì–´ë–»ê²Œ ì§„í–‰í• ê¹Œìš”?",
      "options": [
        {"id": "provide", "label": "ì •ë³´ ì œê³µ - ì§ì ‘ ì•Œë ¤ë“œë¦´ê²Œìš”"},
        {"id": "infer", "label": "ì¶”ë¡  í—ˆìš© - AIê°€ ì¶”ì •í•´ë„ ë©ë‹ˆë‹¤"},
        {"id": "skip", "label": "ê±´ë„ˆë›°ê¸° - ë‚˜ì¤‘ì— ë³´ì™„í• ê²Œìš”"}
      ]
    }
  ]
}
```

- `provide` â†’ ì‚¬ìš©ì ì…ë ¥ ë°›ì•„ ë³´ì™„
- `infer` â†’ AIê°€ ì¶”ì •, Assumptions ì„¹ì…˜ì— ëª…ì‹œ
- `skip` â†’ í•´ë‹¹ í•­ëª© "[TBD]" í‘œì‹œ í›„ ì§„í–‰

### ì™„ë£Œ ìµœì†Œ ì¡°ê±´ (Fail Gate)

ì•„ë˜ ì¡°ê±´ ì¤‘ **í•´ë‹¹ë˜ëŠ” í•­ëª©ì´ ë¹„ì–´ìˆìœ¼ë©´ í˜‘ì˜ ë‹¨ê³„ë¡œ ë˜ëŒë¦¼**:

| ì¡°ê±´ | í•´ë‹¹ ì‹œ ìµœì†Œ ìš”êµ¬ì‚¬í•­ |
|------|---------------------|
| **APIê°€ ìˆìœ¼ë©´** | ìš”ì²­/ì‘ë‹µ ìŠ¤í™ + ëŒ€í‘œ ì—ëŸ¬ ì‘ë‹µ 2ê°œ ì´ìƒ |
| **ê¶Œí•œì´ ìˆìœ¼ë©´** | Role/Permission í‘œ ìµœì†Œ 1ê°œ |
| **ë°ì´í„°(DB) ìˆìœ¼ë©´** | í•µì‹¬ ì—”í‹°í‹° í•„ë“œ 5ê°œ ì´ìƒ ì •ì˜ |

âš ï¸ í•˜ë‚˜ë¼ë„ ë¯¸ë‹¬ ì‹œ â†’ "í•´ë‹¹ ì •ë³´ ë³´ì™„ í•„ìš”" ì•ˆë‚´ í›„ Phase 5.5 ì¬ì§„ì…

**ëª¨ë“  í•„ìˆ˜ í•­ëª© í†µê³¼ ì‹œ** â†’ Phase 6ìœ¼ë¡œ ì§„í–‰

---

## Phase 6: ì„¤ê³„ ë¬¸ì„œ ì‘ì„±

í˜‘ì˜ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ **ê°œë°œ ì°©ìˆ˜ ê°€ëŠ¥í•œ ì„¤ê³„ ë¬¸ì„œ** ì‘ì„±.

### ì„¹ì…˜ë³„ ì‘ì„± ê°€ì´ë“œ

| ì„¹ì…˜ | ë‚´ìš© | ì†ŒìŠ¤ |
|------|------|------|
| 0. Summary | Goal/Non-goals/Success metrics | ìš”êµ¬ì‚¬í•­ MDì—ì„œ ì¶”ì¶œ |
| 1. Scope | In/Out scope | í˜‘ì˜ì—ì„œ í™•ì •ëœ ë²”ìœ„ |
| 1.5. Tech Stack | ì–¸ì–´, í”„ë ˆì„ì›Œí¬, DB, ì„œë“œíŒŒí‹°, ì¸í”„ë¼ | í”„ë¡œì íŠ¸ íƒìƒ‰ ë˜ëŠ” ì‚¬ìš©ì ì…ë ¥ |
| 2. Architecture Impact | Components, Data ë³€ê²½ì‚¬í•­ | Domain Architect ì„¤ê³„ì•ˆ |
| 3. Code Mapping | ê¸°ëŠ¥ â†’ íŒŒì¼/ëª¨ë“ˆ ë§¤í•‘ | Domain Architect ì„¤ê³„ì•ˆ + í”„ë¡œì íŠ¸ íƒìƒ‰ |
| 4. Implementation Plan | êµ¬í˜„ ìˆœì„œ | í˜‘ì˜ëœ ìš°ì„ ìˆœìœ„ |
| 5. Sequence Diagram | ì£¼ìš” í”Œë¡œìš° ì‹œê°í™” | ë©”ì¸ ì—ì´ì „íŠ¸ê°€ ìƒì„¸í™” |
| 6. API Specification | ì—”ë“œí¬ì¸íŠ¸, Request/Response | ë©”ì¸ ì—ì´ì „íŠ¸ê°€ ìƒì„¸í™” |
| 7. Infra/Ops | í™˜ê²½ë³€ìˆ˜, ë°°í¬ ë³€ê²½ | Domain Architect ì„¤ê³„ì•ˆ |
| 8. Risks & Tradeoffs | **í˜‘ì˜ ê²°ë¡  í•µì‹¬** | ì–‘ì¸¡ ì£¼ì¥ + ì±„íƒ ì´ìœ  |
| 9. Error/Auth/Data Checklist | **3ëŒ€ í•„ìˆ˜ ì²´í¬** | ì—ëŸ¬ ì²˜ë¦¬, ê¶Œí•œ, ë°ì´í„° ì •í•©ì„± |

### Section 1.5 ìƒì„¸ (Tech Stack)

**í”„ë¡œì íŠ¸ ê¸°ìˆ  ìŠ¤íƒ ëª…ì‹œ:**

| í•­ëª© | ì˜ˆì‹œ |
|------|------|
| Language | Python 3.11 / TypeScript 5.x / Go 1.21 / Java 17 |
| Framework | FastAPI / NestJS / Spring Boot / Gin |
| DB | PostgreSQL 15 / MySQL 8 / MongoDB 6 |
| ORM | SQLAlchemy / Prisma / TypeORM / GORM / ì—†ìŒ (Raw SQL) |
| ì„œë“œíŒŒí‹° | Redis, Kafka, S3, Elasticsearch ë“± |
| ì¸í”„ë¼ | K8s / Docker / AWS / GCP / On-premise |

**í”„ë¡œì íŠ¸ íƒìƒ‰ ë˜ëŠ” ì‚¬ìš©ì ì…ë ¥ìœ¼ë¡œ í™•ì¸**

### Section 2 ìƒì„¸ (Database Changes)

**ëª¨ë“  í…Œì´ë¸”ì— ëŒ€í•´ ì „ì²´ ì»¬ëŸ¼ ì •ì˜ í•„ìˆ˜:**

| êµ¬ë¶„ | ì‘ì„± ë‚´ìš© |
|------|----------|
| ì‹ ê·œ í…Œì´ë¸” | ëª¨ë“  ì»¬ëŸ¼ ì •ì˜ (Column, Type, Constraints, Description) |
| ê¸°ì¡´ í…Œì´ë¸” ìˆ˜ì • | **ìˆ˜ì • ì „/í›„ ì „ì²´ ìŠ¤í‚¤ë§ˆ** ë˜ëŠ” **í˜„ì¬ ì „ì²´ ìŠ¤í‚¤ë§ˆ + ë³€ê²½ì‚¬í•­ ëª…ì‹œ** |

**ì•ˆí‹°íŒ¨í„´ (ê¸ˆì§€):**
- "ê¸°ì¡´ í…Œì´ë¸”ì—ì„œ X í•„ë“œ ì‚­ì œ" (â†’ ì „ì²´ ìŠ¤í‚¤ë§ˆ ì—†ì´ ë³€ê²½ë§Œ ì–¸ê¸‰)
- "ê¸°ì¡´ í…Œì´ë¸” ìˆ˜ì •" (â†’ ì–´ë–¤ ì»¬ëŸ¼ì´ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìŒ)

**ì˜ˆì‹œ:**

| Column | Type | Change | Description |
|--------|------|--------|-------------|
| id | INTEGER | ìœ ì§€ | PK |
| event_type | VARCHAR(100) | ìœ ì§€ | ì´ë²¤íŠ¸ íƒ€ì… |
| reference_id | VARCHAR(100) | **ì‹ ê·œ** | ê´€ë ¨ ë¦¬ì†ŒìŠ¤ ID |
| ~~is_read~~ | ~~BOOLEAN~~ | **ì‚­ì œ** | â†’ ë³„ë„ í…Œì´ë¸”ë¡œ ì´ì „ |

### Section 2 ì¶”ê°€: Database Migration (ìˆ˜ë™ SQL ì„ íƒ ì‹œ)

ë§ˆì´ê·¸ë ˆì´ì…˜ ë°©ì‹ì´ "ìˆ˜ë™ SQL"ì¸ ê²½ìš°, êµ¬í˜„ ë‹¨ê³„ì—ì„œ SQL ìƒì„±ì„ ìœ„í•´ ì•„ë˜ ë‚´ìš© ê¸°ë¡:

| ë³€ê²½ ìœ í˜• | í…Œì´ë¸” | ë‚´ìš© |
|----------|--------|------|
| CREATE TABLE | alert_read_status | ì‹ ê·œ í…Œì´ë¸” |
| ALTER TABLE | alert | is_read ì»¬ëŸ¼ ì‚­ì œ |
| CREATE INDEX | alert_read_status | user_id ì¸ë±ìŠ¤ ì¶”ê°€ |

**ì°¸ê³ **: ì‹¤ì œ SQLì€ êµ¬í˜„ ë‹¨ê³„ì—ì„œ DB ì¢…ë¥˜ì— ë§ê²Œ ìƒì„±ë¨

### Section 3 ìƒì„¸ (Code Mapping - ì—°ë™)

**ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™ ì‹œ êµ¬ì²´ì ì¸ í˜¸ì¶œ ìœ„ì¹˜ í•„ìˆ˜:**

| í•„ìˆ˜ ì •ë³´ | ì„¤ëª… |
|----------|------|
| íŒŒì¼ ê²½ë¡œ | ì „ì²´ ê²½ë¡œ (ì˜ˆ: `apps/issue/src/services/quality_issue/service.py`) |
| í´ë˜ìŠ¤ëª… | ìˆ˜ì •í•  í´ë˜ìŠ¤ |
| **ë©”ì„œë“œëª…** | ìˆ˜ì •í•  ë©”ì„œë“œ (ì˜ˆ: `create_issue()`, `resolve_issue()`) |
| **í˜¸ì¶œ ìœ„ì¹˜** | ë©”ì„œë“œ ë‚´ ì–´ëŠ ì‹œì  (ì˜ˆ: "DB ì €ì¥ í›„, ì‘ë‹µ ë°˜í™˜ ì „") |
| í˜¸ì¶œí•  ì½”ë“œ | ì¶”ê°€í•  ì½”ë“œ ìŠ¤ë‹ˆí« |

**ì•ˆí‹°íŒ¨í„´ (ê¸ˆì§€):**
- "Issue ì„œë¹„ìŠ¤ì—ì„œ AlertPublisher í˜¸ì¶œ" (â†’ ì–´ë–¤ ë©”ì„œë“œì—ì„œ?)
- "src/services/*.py (ìˆ˜ì •)" (â†’ êµ¬ì²´ì ì¸ íŒŒì¼ê³¼ ë©”ì„œë“œê°€ ì—†ìŒ)

**ì˜ˆì‹œ:**

| Feature | File | Class | Method | Action |
|---------|------|-------|--------|--------|
| Quality Create | `.../quality_issue/service.py` | `QualityIssueService` | `create_issue()` | DB ì €ì¥ í›„ `_publish_create_alert()` |
| Quality Resolve | `.../quality_issue/service.py` | `QualityIssueService` | `resolve_issue()` | ìƒíƒœ ë³€ê²½ í›„ `_publish_resolve_alert()` |

### Section 8 ìƒì„¸ (í˜‘ì˜ ê²°ë¡ )

```markdown
## 8. Risks & Tradeoffs (Debate Conclusion)

### Chosen Option
- (ì±„íƒëœ ì„¤ê³„ ë°©ì‹)

### Rejected Alternatives
- (Best Practice ì œì•ˆ ì¤‘ ë¯¸ì±„íƒ í•­ëª©ê³¼ ì´ìœ )

### Reasoning
- í”„ë¡œì íŠ¸ ì œì•½: ...
- ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ìˆ˜ìš©: ...
- í–¥í›„ ê°œì„  ê°€ëŠ¥ í¬ì¸íŠ¸: ...

### Assumptions (ê°€ì •)
- **í™•ì •ëœ ê²ƒ**: (í˜‘ì˜ì—ì„œ ëª…í™•íˆ ê²°ì •ëœ ê²ƒ)
- **ì¶”ì •í•œ ê²ƒ**: (í™•ì¸ë˜ì§€ ì•Šì•„ ê°€ì •í•œ ê²ƒ)
```

### ì €ì¥ ê²½ë¡œ

**ê²½ë¡œ**: `docs/{serviceName}/architect.md`

serviceNameì€ ì…ë ¥ íŒŒì¼ ê²½ë¡œì—ì„œ ì¶”ë¡ :
- ì…ë ¥: `docs/alert/requirements.md`
- ì¶œë ¥: `docs/alert/architect.md`

---

# ì¶œë ¥ ë¬¸ì„œ í…œí”Œë¦¿

```markdown
# Feature Design Doc: {ê¸°ëŠ¥ëª…}

> ìƒì„±ì¼: {ë‚ ì§œ}
> ì„œë¹„ìŠ¤: {serviceName}
> ìš”êµ¬ì‚¬í•­ ë¬¸ì„œ: docs/{serviceName}/requirements.md

## 0. Summary

### Goal
(ì´ ê¸°ëŠ¥ì´ ë‹¬ì„±í•˜ë ¤ëŠ” ëª©í‘œ - 1-2ë¬¸ì¥)

### Non-goals
- (ì´ë²ˆ ë²”ìœ„ì—ì„œ ì œì™¸ë˜ëŠ” ê²ƒë“¤)

### Success metrics
- (ì„±ê³µ ê¸°ì¤€ ëª©ë¡)

---

## 1. Scope

### In scope
- (ì´ë²ˆ êµ¬í˜„ì— í¬í•¨ë˜ëŠ” ê²ƒë“¤)

### Out of scope
- (í–¥í›„ ê°œì„  ë˜ëŠ” ì œì™¸ í•­ëª©)

---

## 1.5. Tech Stack

| í•­ëª© | ê°’ |
|------|-----|
| Language | {ì–¸ì–´ ë° ë²„ì „} |
| Framework | {í”„ë ˆì„ì›Œí¬} |
| DB | {DB ì¢…ë¥˜ ë° ë²„ì „} |
| ORM | {ORM íŒ¨í‚¤ì§€ ë˜ëŠ” "Raw SQL"} |
| ì„œë“œíŒŒí‹° | {Redis, Kafka ë“±} |
| ì¸í”„ë¼ | {K8s, Docker ë“±} |

---

## 2. Architecture Impact

### Components

| Service / Module | Responsibility | Change type |
|-----------------|----------------|-------------|
| {ì„œë¹„ìŠ¤ëª…} | {ì—­í• } | new / modify |

### Data

#### Database changes

**ì‹ ê·œ í…Œì´ë¸”: `{í…Œì´ë¸”ëª…}`**

| Column | Type | Constraints | Description |
|--------|------|-------------|-------------|
| id | INTEGER | PK, AUTO_INCREMENT | ê¸°ë³¸ í‚¤ |
| {ì»¬ëŸ¼ëª…} | {íƒ€ì…} | {ì œì•½ì¡°ê±´} | {ì„¤ëª…} |
| created_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | ìƒì„± ì‹œê° |

**ê¸°ì¡´ í…Œì´ë¸” ìˆ˜ì •: `{í…Œì´ë¸”ëª…}`**

| Column | Type | Change | Description |
|--------|------|--------|-------------|
| id | INTEGER | ìœ ì§€ | PK |
| {ì»¬ëŸ¼ëª…} | {íƒ€ì…} | **ì‹ ê·œ** / **ì‚­ì œ** / ìœ ì§€ | {ì„¤ëª…} |

#### Migration Summary (ìˆ˜ë™ SQL ì„ íƒ ì‹œ)

| ë³€ê²½ ìœ í˜• | í…Œì´ë¸” | ë‚´ìš© |
|----------|--------|------|
| CREATE TABLE | {í…Œì´ë¸”} | {ì„¤ëª…} |
| ALTER TABLE | {í…Œì´ë¸”} | {ë³€ê²½ ë‚´ìš©} |
| CREATE INDEX | {í…Œì´ë¸”} | {ì¸ë±ìŠ¤ ì„¤ëª…} |

---

## 3. Code Mapping

| Feature | File | Class | Method | Action |
|---------|------|-------|--------|--------|
| {ê¸°ëŠ¥} | {íŒŒì¼ ì „ì²´ ê²½ë¡œ} | {í´ë˜ìŠ¤ëª…} | {ë©”ì„œë“œëª…} | {í˜¸ì¶œ ìœ„ì¹˜ ë° ì¶”ê°€ ì½”ë“œ} |

---

## 4. Implementation Plan

### ğŸ“‚ í•„ìˆ˜ ì°¸ì¡° íŒŒì¼ (êµ¬í˜„ ì „ í•„ë…)

| íŒŒì¼ | ì°¸ì¡° ëª©ì  |
|------|----------|
| {íŒŒì¼ ê²½ë¡œ 1} | {ì´ íŒŒì¼ì—ì„œ í™•ì¸í•  ë‚´ìš© - íŒ¨í„´, ìŠ¤íƒ€ì¼, ì˜ì¡´ì„± ë“±} |
| {íŒŒì¼ ê²½ë¡œ 2} | {ì°¸ì¡° ëª©ì } |
| {íŒŒì¼ ê²½ë¡œ 3} | {ì°¸ì¡° ëª©ì } |

âš ï¸ **implement ìŠ¤í‚¬ ì‹¤í–‰ ì‹œ ìœ„ íŒŒì¼ë“¤ì„ ë¨¼ì € ì½ê³  íŒ¨í„´ì„ íŒŒì•…í•  ê²ƒ**

### ë‹¨ê³„ë³„ êµ¬í˜„

1. **ë‹¨ê³„ 1: {ë‹¨ê³„ëª…}**
   - {ì„¸ë¶€ ì‘ì—… 1}
   - {ì„¸ë¶€ ì‘ì—… 2}

2. **ë‹¨ê³„ 2: {ë‹¨ê³„ëª…}**
   - {ì„¸ë¶€ ì‘ì—…}

3. **ë‹¨ê³„ 3: {ë‹¨ê³„ëª…}**
   - {ì„¸ë¶€ ì‘ì—…}

---

## 5. Sequence Diagram

### {í”Œë¡œìš°ëª…}

\`\`\`mermaid
sequenceDiagram
    participant Client
    participant API
    participant Service
    participant DB

    Client->>API: {ìš”ì²­}
    API->>Service: {ë©”ì„œë“œ í˜¸ì¶œ}
    Service->>DB: {DB ì‘ì—…}
    DB-->>Service: {ê²°ê³¼}
    Service-->>API: {ë°˜í™˜}
    API-->>Client: {ì‘ë‹µ}
\`\`\`

---

## 6. API Specification

### {API ì´ë¦„}

**Endpoint**: `{METHOD} /api/v1/{path}`

**Request**:
\`\`\`json
{
  "field": "value"
}
\`\`\`

**Response**:
\`\`\`json
{
  "success": true,
  "data": {}
}
\`\`\`

---

## 7. Infra/Ops

### í™˜ê²½ë³€ìˆ˜
| ë³€ìˆ˜ëª… | ì„¤ëª… | ê¸°ë³¸ê°’ |
|--------|------|--------|
| {VAR_NAME} | {ì„¤ëª…} | {ê°’} |

### ë°°í¬ ë³€ê²½
- (í•„ìš” ì‹œ)

---

## 8. Risks & Tradeoffs (Debate Conclusion)

### Chosen Option
- {ì±„íƒëœ ì„¤ê³„ ë°©ì‹}

### Rejected Alternatives
- {ë¯¸ì±„íƒ í•­ëª©ê³¼ ì´ìœ }

### Reasoning
- í”„ë¡œì íŠ¸ ì œì•½: {ì´ìœ }
- ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ ìˆ˜ìš©: {ì ìš©í•œ ë¶€ë¶„}
- í–¥í›„ ê°œì„  ê°€ëŠ¥ í¬ì¸íŠ¸: {ë‚˜ì¤‘ì— í•  ê²ƒ}

### Assumptions (ê°€ì •)
- **í™•ì •ëœ ê²ƒ**: {í˜‘ì˜ì—ì„œ ëª…í™•íˆ ê²°ì •ëœ ê²ƒ}
- **ì¶”ì •í•œ ê²ƒ**: {í™•ì¸ë˜ì§€ ì•Šì•„ ê°€ì •í•œ ê²ƒ - êµ¬í˜„ ì‹œ ê²€ì¦ í•„ìš”}

---

## 9. Error/Auth/Data Checklist (3ëŒ€ í•„ìˆ˜ ì²´í¬)

### ì—ëŸ¬ ì²˜ë¦¬ (Error Handling)

| ìƒí™© | ë°œìƒ ìœ„ì¹˜ | ì²˜ë¦¬ ë°©ì‹ | ì‘ë‹µ |
|------|----------|----------|------|
| {ì˜ˆì™¸ ìƒí™©} | {íŒŒì¼/ë©”ì„œë“œ} | {try-catch/ì˜ˆì™¸ ì „íŒŒ/ë¡œê¹…} | {HTTP ì½”ë“œ, ì—ëŸ¬ ë©”ì‹œì§€} |

### ê¶Œí•œ ê²€ì¦ (Authorization)

| ì‘ì—… | í•„ìš” ê¶Œí•œ | ê²€ì¦ ìœ„ì¹˜ | ì‹¤íŒ¨ ì‹œ |
|------|----------|----------|--------|
| {API/ê¸°ëŠ¥} | {role/permission} | {ë¯¸ë“¤ì›¨ì–´/ì„œë¹„ìŠ¤} | {403/401 ì‘ë‹µ} |

### ë°ì´í„° ì •í•©ì„± (Data Integrity)

| ê²€ì¦ í•­ëª© | ê²€ì¦ ì‹œì  | ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬ |
|----------|----------|------------|
| {FK ì¡´ì¬ ì—¬ë¶€} | {ì €ì¥ ì „} | {400 + ë©”ì‹œì§€} |
| {ì¤‘ë³µ ì²´í¬} | {ìƒì„± ì‹œ} | {409 Conflict} |
| {ë²”ìœ„ ê²€ì¦} | {ì…ë ¥ ì‹œ} | {422 + ìƒì„¸} |

âš ï¸ **ì´ ì„¹ì…˜ì´ ë¹„ì–´ìˆìœ¼ë©´ êµ¬í˜„ ì‹œ 80%ê°€ í”ë“¤ë¦¼** - ë°˜ë“œì‹œ ì‘ì„±
```

---

# ì™„ë£Œ í›„ ì•ˆë‚´

ë¬¸ì„œ ì €ì¥ í›„ ì‚¬ìš©ìì—ê²Œ ì•ˆë‚´:

> âœ… **ì„¤ê³„ ë¬¸ì„œ ì‘ì„± ì™„ë£Œ**
>
> ì €ì¥ ìœ„ì¹˜: `docs/{serviceName}/architect.md`
>
> **ë‹¤ìŒ ë‹¨ê³„**: `implement` ìŠ¤í‚¬ì„ ì‹¤í–‰í•˜ì—¬ êµ¬í˜„ì„ ì‹œì‘í•˜ì„¸ìš”.
> â†’ ìƒˆ ì„¸ì…˜ì—ì„œ **Sonnet ëª¨ë¸**ë¡œ ë³€ê²½ í›„ ì‹¤í–‰ ê¶Œì¥ (ë¹„ìš© ì ˆê°)

---

# ì—°ê³„

```
[require-refine] â†’ docs/{serviceName}/requirements.md
        â†“
[architect] â†’ docs/{serviceName}/architect.md
        â†“
[implement] â†’ êµ¬í˜„
        â†“
(ë²„ê·¸ ë°œìƒ)
        â†“
[bugfix] â†’ docs/{serviceName}/changelog.md
```
